/*!
 * Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see https://ckeditor.com/legal/ckeditor-oss-license
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.userAdapter=t())}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var s in i)e.o(i,s)&&!e.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:i[s]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{default:()=>i});const i={UserAdapter:class{constructor(e){this.editor=e}static get pluginName(){return"UserAdapter"}init(){if(void 0===this.editor.sourceElement)return;if(void 0===drupalSettings.ckeditor5Premium||!this.editor.plugins.has("Users"))return;const e=this.editor.plugins.get("Users"),t=drupalSettings.ckeditor5Premium.users;for(const i in t)e.addUser(t[i]);e.defineMe(drupalSettings.user.uid),this.editor.on("ready",(()=>{this.setPermissions()}))}setPermissions(){let e=this.editor.sourceElement.getAttribute("data-editor-active-text-format"),t=this.editor.plugins.get("Permissions"),i=drupalSettings.ckeditor5Premium.current_user.editor_permission[e];const s=this.editor.plugins.has("TrackChanges");if("object"!=typeof i)this.editor.enableReadOnlyMode(this.editor.id);else{let e=i.indexOf("document:admin");t.setPermissions(i),1===i.length&&"comment:write"===i[0]&&this.disablePlugins("commentOnly"),i.includes("document:write")&&-1===e&&(s?(this.editor.execute("trackChanges"),this.editor.commands.get("acceptSuggestion").forceDisabled("suggestionOnly"),this.editor.commands.get("acceptAllSuggestions").forceDisabled("suggestionOnly"),this.editor.commands.get("discardAllSuggestions").forceDisabled("suggestionOnly"),this.editor.commands.get("discardSuggestion").forceDisabled("suggestionOnly"),this.editor.commands.get("trackChanges").forceDisabled("suggestionOnly"),this.disablePlugins("suggestionOnly")):this.editor.enableReadOnlyMode(this.editor.id))}}disablePlugins(e){const t=this.editor.plugins;t.has("SourceEditing")&&t.get("SourceEditing").forceDisabled(e),t.has("SourceEditingAdvanced")&&t.get("SourceEditingAdvanced").forceDisabled(e),t.has("RevisionTracker")&&t.get("RevisionTracker").forceDisabled(e),t.has("TrackChanges")&&t.get("TrackChanges").forceDisabled(e)}}};return t=t.default})()));