/*!
 * Copyright (c) 2003-2025, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see https://ckeditor.com/legal/ckeditor-oss-license
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.errorNotifications=t())}(self,(()=>(()=>{"use strict";var e={d:(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})}};e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),e.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var t={};e.d(t,{default:()=>d});const{View:i}=window.CKEditor5.ui,{Rect:o,Collection:r}=window.CKEditor5.utils,{Plugin:s}=window.CKEditor5.core,n=[{header:"Oops...",description:"It seems that the editor encountered an error. Save your content and refresh the page. If the error persists, contact your site administrator.",type:"error",reactsTo:{name:"CKEditorError"}},{header:"Trial limit exceeded",description:"You have exhausted the trial usage limit. Restart the editor - you can reload the page or save edited content.",type:"error",reactsTo:{message:"trial-license-key-reached-limit"}},{header:"Trial limit exceeded",description:"You have reached the usage limit of your trial license key. Restart the editor - you can reload the page or save edited content.",type:"error",reactsTo:{message:"license-key-trial-limit"}},{header:"Usage limit reached",description:"You have reached the usage limit of your license key. Please contact our customer support to extend the limit at https://ckeditor.com/contact/.",type:"error",reactsTo:{message:"license-key-usage-limit"}},{header:"WProofreader Authorization Error",description:"Some problems occurred during WProofreader initialization. Check the WProofreader plugin configuration.",type:"error",reactsTo:{message:"wproofreader-service-id-error"}},{header:"WProofreader usage limit exceeded",description:"The daily limit for the number of words checked using the WProofreader grammar and spell checker has been reached. Please contact your site administrator for help. Access to the service will resume at 00:00 UTC.",type:"error",reactsTo:{message:"wproofreader-usage-limit-error"}},{header:"WProofreader Error",description:"You have no permission to access the WProofreader proxy.",type:"error",reactsTo:{message:"wproofreader-permission-error"}},{header:"Access denied",description:"You don't have enough permissions for this action.",type:"unhandledrejection",reactsTo:{message:"You don't have enough permissions to access this resource"}}];class a extends i{constructor(t,i){super(t),this.reactsTo=i.reactsTo,this.closeNotificationButton=null,this.set("_editable",null),this.set("isVisible",!1),this.set("positionBottom","20px"),this.set("positionRight","15px"),this.createTemplate(i),this.render(),this.on("change:isVisible",(()=>this._updateNotificationPosition())),this.listenTo(e.g.document,"scroll",((e,t)=>{this.isVisible&&this._updateNotificationPosition()}))}createTemplate(e){const t=this.bindTemplate,i=this._createNotificationHeader(e.header,e.type),o=this._createNotificationDescription(e.description),r=this._createCloseNotificationButton();this.setTemplate({tag:"div",attributes:{class:["ck-notification",`ck-notification__${e.type}`,t.if("isVisible","ck-hidden",(e=>!e))],style:{position:"absolute",bottom:t.to("positionBottom"),right:t.to("positionRight"),"z-index":999}},children:[i,o,r]})}show(){this.isVisible=!0}hide(){this.isVisible=!1}_createNotificationHeader(e,t){const o=new i;return o.setTemplate({tag:"h4",attributes:{class:["ck-notification__header",`ck-notification__header-${t}`]},children:[e]}),o}_createNotificationDescription(e){const t=new i;return t.setTemplate({tag:"p",attributes:{class:["ck-notification__description"]},children:[e]}),t}_createCloseNotificationButton(){const e=new i,t=e.bindTemplate;return e.setTemplate({tag:"span",attributes:{class:["ck-notification__close"]},children:["x"],on:{click:t.to((e=>this.fire("closeNotification")))}}),e}_updateNotificationPosition(){const e=this._editable;if(!e)return;const t=new o(e).getVisible(),i=window.innerHeight,r=t.bottom-i;t.top>=i-100||(t.bottom>i?this.set("positionBottom",`${r+20}px`):this.set("positionBottom","20px"))}}const c=class extends s{constructor(...e){super(...e),this.availableNotifications=new r,this.activeNotification=null}static get pluginName(){return"ErrorNotifications"}init(){const e=this.editor;this._setupNotifications(n),this.set("_editable",null),e.ui.once("ready",(()=>this.set("_editable",e.ui.view.editable.element))),this._attachListeners()}destroy(){this.activeNotification&&(this.activeNotification.hide(),this.editor.ui.view.main.remove(this.activeNotification)),this.activeNotification=null,this._detachListeners(),super.destroy()}_setupNotifications(e){for(const t of e){const e=new a(this.editor.locale,t);e.bind("_editable").to(this,"_editable"),e.on("closeNotification",(()=>{e.hide(),this.activeNotification=null,this.editor.ui.view.main.remove(e),this.editor.editing.view.focus()})),this.availableNotifications.add(e)}}_attachListeners(){window.addEventListener("error",this._handleError.bind(this)),window.addEventListener("unhandledrejection",this._handleError.bind(this))}_detachListeners(){window.removeEventListener("error",this._handleError.bind(this)),window.removeEventListener("unhandledrejection",this._handleError.bind(this))}_handleError(e){let t=null;const i=new r;if(!(this.activeNotification||"error"===e.type&&!e.error||"unhandledrejection"===e.type&&!e.reason)){for(const t of this.availableNotifications){const o=t.reactsTo;for(const r in o)"error"===e.type&&e.error[r]&&e.error[r].includes(o[r])&&i.add(t),"unhandledrejection"===e.type&&e.reason[r]&&e.reason[r].includes(o[r])&&i.add(t)}t=i.length>1?i.find((e=>e.reactsTo.message)):i.first,t&&(this.activeNotification=t,this.activeNotification.show(),this.editor.ui.view.main.add(this.activeNotification))}}},d={ErrorNotifications:c};return t=t.default})()));